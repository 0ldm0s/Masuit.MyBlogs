myApp.controller("mergelist",["$scope","$http","NgTableParams","$timeout",function(n,t,i,r){var u,f;window.hub.stop();u=this;n.kw="";n.orderby=1;n.paginationConf={currentPage:n.currentPage?n.currentPage:1,itemsPerPage:10,pagesLength:25,perPageOptions:[1,5,10,15,20,30,40,50,100,200],rememberPerPage:"perPageItems",onChange:function(){u.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)}};this.GetPageData=function(r,f){t.get("/merge?page="+r+"&size="+f+"&kw="+n.kw).then(function(t){n.paginationConf.currentPage=r;n.paginationConf.totalItems=t.data.TotalCount;$("div[ng-table-pagination]").remove();u.tableParams=new i({count:5e4},{filterDelay:0,dataset:t.data.Data})})};u.pass=function(t){swal({title:"确认直接合并这篇文章吗？",text:t.Title,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/merge/"+t.Id,null,function(t){window.notie.alert({type:1,text:t.Message,time:4});u.stats=[];u.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)})},function(){}).catch(swal.noop)};u.reject=function(t){swal({title:"拒绝合并理由：",input:"textarea",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1,inputValidator:function(n){return new Promise(function(t,i){n?t():i("请填写拒绝理由!")})}}).then(function(){n.request("/merge/reject/"+t.Id,null,function(t){window.notie.alert({type:1,text:t.Message,time:4});u.stats=[];u.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)})},function(){}).catch(swal.noop)};u.block=function(t){swal({title:"确认标记为恶意修改吗？",text:t.Title,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/merge/block/"+t.Id,null,function(t){window.notie.alert({type:1,text:t.Message,time:4});u.stats=[];u.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)})},function(){}).catch(swal.noop)};n.search=function(t){f&&r.cancel(f);f=r(function(){n.kw=t;u.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage,n.kw);f=null},500)}}]);myApp.controller("mergecompare",["$scope","$http","$timeout","$location",function(n,t,i,r){window.hub.stop();clearInterval(window.interval);n.id=r.search().id;n.get("/merge/compare/"+n.id,function(t){var i=t.Data;n.old=i.old;n.newer=i.newer});n.pass=function(){swal({title:"确认直接合并这篇文章吗？",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/merge/"+n.id,null,function(n){window.notie.alert({type:1,text:n.Message,time:4});window.location.href="#/merge/list"})},function(){}).catch(swal.noop)};n.reject=function(){swal({title:"拒绝合并理由：",input:"textarea",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1,inputValidator:function(n){return new Promise(function(t,i){n?t():i("请填写拒绝理由!")})}}).then(function(t){n.request("/merge/reject/"+n.id,{reason:t},function(n){window.notie.alert({type:1,text:n.Message,time:4});window.location.href="#/merge/list"})},function(){}).catch(swal.noop)};n.block=function(){swal({title:"确认标记为恶意修改吗？",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/merge/block/"+n.id,null,function(t){window.notie.alert({type:1,text:t.Message,time:4});self.stats=[];self.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)})},function(){}).catch(swal.noop)}}]);myApp.controller("mergeedit",["$scope","$http","$timeout","$location",function(n,t,i,r){window.hub.stop();clearInterval(window.interval);n.id=r.search().id;n.get("/merge/"+n.id,function(t){n.post=t.Data});n.merge=function(){n.request("/merge",n.post,function(n){window.notie.alert({type:1,text:n.Message,time:4});window.location.href="#/merge/list"})}}]);