myApp.controller("miscAdd",["$scope","$http","$location","$timeout",function(n,t,i){window.hub.stop();n.misc={};n.loading();n.misc.Id=i.search().id;n.misc.Id&&n.request("/misc/get",{id:n.misc.Id},function(t){n.misc=t.Data});n.submit=function(i){n.loading();var r="/misc/write";i.Id?r="/misc/edit":i={Title:i.Title,Content:i.Content};t.post(r,i).then(function(t){var i=t.data;n.loadingDone();i.Success?(window.notie.alert({type:1,text:i.Message,time:4}),n.misc.Content="",n.misc.Title=""):window.notie.alert({type:3,text:i.Message,time:4})})};n.loadingDone()}]);myApp.controller("miscList",["$scope","$http","NgTableParams",function(n,t,i){window.hub.stop();var r=this;n.loading();n.paginationConf={currentPage:n.currentPage?n.currentPage:1,itemsPerPage:10,pagesLength:25,perPageOptions:[1,5,10,15,20,30,40,50,100,200],rememberPerPage:"perPageItems",onChange:function(){r.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)}};this.GetPageData=function(u,f){n.loading();t.post("/misc/getpagedata",{page:u,size:f}).then(function(t){n.paginationConf.currentPage=u;n.paginationConf.totalItems=t.data.TotalCount;$("div[ng-table-pagination]").remove();r.tableParams=new i({count:5e4},{filterDelay:0,dataset:t.data.Data});n.loadingDone()})};r.del=function(t){swal({title:"确认删除这条公告吗？",text:t.Title,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/misc/delete",{id:t.Id},function(n){window.notie.alert({type:1,text:n.Message,time:4})});_.remove(r.tableParams.settings().dataset,function(n){return t===n});r.tableParams.reload().then(function(n){n.length===0&&r.tableParams.total()>0&&(r.tableParams.page(r.tableParams.page()-1),r.tableParams.reload())})},function(){}).catch(swal.noop)};n.loadingDone()}]);