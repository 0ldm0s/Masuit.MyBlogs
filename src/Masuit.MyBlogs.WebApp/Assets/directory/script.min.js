$(function(){function n(n,t){this.opts=$.extend(!0,{scrollThreshold:.1,scrollSpeed:700,scrollTopBorder:500,easing:"swing",delayDetection:200,scrollChange:function(){}},t);this.$win=$(window);this.$h=n;this.$pageNavList="";this.$pageNavListLis="";this.$curTag="";this.$pageNavListLiH="";this.offArr=[];this.curIndex=0;this.scrollIng=!1;this.init()}if(n.prototype={init:function(){this.make();this.setArr();this.bindEvent()},make:function(){$("body").append('<div class="directory-nav" id="directoryNav"><ul><\/ul><span class="cur-tag"><\/span><span class="c-top"><\/span><span class="c-bottom"><\/span><span class="line"><\/span><\/div>>');var u=this.$h,r=$("#directoryNav"),t=[],n=0,i=0;u.each(function(){var u=$(this),r=u.text();this.tagName.toLowerCase()=="h2"?(n++,n%2==0&&(i=0),t.push('<li class="l1"><span class="c-dot"><\/span>'+n+'. <a class="l1-text">'+r+"<\/a><\/li>")):(i++,t.push('<li class="l2">'+n+"."+i+' <a class="l2-text">'+r+"<\/a><\/li>"))});r.find("ul").html(t.join(""));this.$pageNavList=r;this.$pageNavListLis=this.$pageNavList.find("li");this.$curTag=this.$pageNavList.find(".cur-tag");this.$pageNavListLiH=this.$pageNavListLis.eq(0).height();this.opts.scrollTopBorder||this.$pageNavList.show()},setArr:function(){var n=this;this.$h.each(function(){var t=$(this),i=Math.round(t.offset().top);n.offArr.push(i)})},posTag:function(n){this.$curTag.css({top:n+"px"})},ifPos:function(n){for(var i,u,r=this.offArr,f=Math.round(this.$win.height()*this.opts.scrollThreshold),t=0;t<r.length;t++)r[t]-f<n&&(i=this.$pageNavListLis.eq(t),u=i.position().top,i.addClass("cur").siblings("li").removeClass("cur"),this.curIndex=t,this.posTag(u+this.$pageNavListLiH*.5),this.opts.scrollChange.call(this))},bindEvent:function(){var n=this,t=!1,i=0;this.$win.on("scroll",function(){var r=$(this);clearTimeout(i);i=setTimeout(function(){n.scrollIng=!0;r.scrollTop()>n.opts.scrollTopBorder?(n.$pageNavListLiH||(n.$pageNavListLiH=n.$pageNavListLis.eq(0).height()),t||(n.$pageNavList.fadeIn(),t=!0),n.ifPos($(this).scrollTop())):t&&(n.$pageNavList.fadeOut(),t=!1)},n.opts.delayDetection)});this.$pageNavList.on("click","li",function(){var t=$(this),i=t.index();n.scrollTo(n.offArr[i])})},scrollTo:function(n,t){var i=this;$("html,body").animate({scrollTop:n},this.opts.scrollSpeed,this.opts.easing,function(){i.scrollIng=!1;t&&this.tagName.toLowerCase()=="body"&&t()})}},window.screen.width>960)var t=new n($(".ibox-content h2,.ibox-content h3,.ibox-content h4,.ibox-content h5"),{scrollTopBorder:0})});