(function(n,t){typeof define=="function"&&define.amd?define(["jquery"],t):typeof exports=="object"?module.exports=t():n.jeDate=t(window.jQuery||$)})(this,function(n){function o(n,t){this.opts=t;this.valCell=n;this.init()}var t={},s=document,e="YYYY|MM|DD|hh|mm|ss|zz",h="YYYY|MM|DD|hh|mm|ss|zz".replace("|zz",""),i=function(n){return window.parseInt(n,10)},u={skinCell:"jedateblue",language:{name:"cn",month:["01","02","03","04","05","06","07","08","09","10","11","12"],weeks:["日","一","二","三","四","五","六"],times:["小时","分钟","秒数"],clear:"清空",today:"今天",yes:"确定",close:"关闭"},trigger:"click",format:"YYYY-MM-DD hh:mm:ss",minDate:"1900-01-01 00:00:00",maxDate:"2099-12-31 23:59:59"},c,r,f;return n.fn.jeDate=function(t){return this.each(function(){return new o(n(this),t||{})})},n.extend({jeDate:function(t,i){return n(t).each(function(){return new o(n(this),i||{})})}}),t.isObj=function(n){for(var t in n)return!0;return!1},t.reMacth=function(n){return n.match(/\w+|d+/g)},t.docScroll=function(n){return n=n?"scrollLeft":"scrollTop",s.body[n]|s.documentElement[n]},t.winarea=function(n){return s.documentElement[n?"clientWidth":"clientHeight"]},t.isLeap=function(n){return n%100!=0&&n%4==0||n%400==0},t.getDaysNum=function(n,r){var u=31;switch(i(r)){case 2:u=t.isLeap(n)?29:28;break;case 4:case 6:case 9:case 11:u=30}return u},t.getYM=function(n,t,i){var r=new Date(n,t-1);return r.setMonth(t-1+i),{y:r.getFullYear(),m:r.getMonth()+1}},t.getPrevMonth=function(n,i,r){return t.getYM(n,i,0-(r||1))},t.getNextMonth=function(n,i,r){return t.getYM(n,i,r||1)},t.digit=function(n){return n<10?"0"+(n|0):n},t.IsNum=function(n){return/^[+-]?\d*\.?\d*$/.test(n)?!0:!1},t.parse=function(r,u,f){r=r.concat(u);var o={},s=e.split("|");return n.each(r,function(n,t){o[s[n]]=i(t)}),f.replace(new RegExp(e,"g"),function(n){return n=="zz"?"00":t.digit(o[n])})},t.checkFormat=function(n){var t=[];return n.replace(new RegExp(e,"g"),function(n){t.push(n)}),t.join("-")},t.parseMatch=function(n){var i=n.split(" ");return t.reMacth(i[0])},t.testFormat=function(t,i){var r=[],u=[],f,o;return t.replace(new RegExp(e,"g"),function(n){r.push(n)}),n.each(["YYYY","MM","DD"],function(t,i){n.each(r,function(n,t){i==t&&u.push(t)})}),f=t.substring(0,2)=="hh"?r.join("-"):u.join("-"),o=f==i?!0:!1,o},t.checkDate=function(n){var i=t.reMacth(n);return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?!1:i[1]>12||i[1]<1?!1:i[2]<1||i[2]>31?!1:(i[1]==4||i[1]==6||i[1]==9||i[1]==11)&&i[2]>30?!1:i[1]==2&&(i[2]>29||(i[0]%100==0&&i[0]%400!=0||i[0]%4!=0)&&i[2]>28)?!1:!0},t.returnDate=function(r,u,f){var o;u=u||"YYYY-MM-DD hh:mm:ss";var w=f==undefined||f==""||f==[],s=w?[]:t.reMacth(f),c=[],l=s.length>0?new Date(s[0],s[1],s[2]||00,s[3]||00,s[4]||00,s[5]||00):new Date,b=l.getMonth(),k=l.getDate(),e=[l.getFullYear(),b,k,l.getHours(),l.getMinutes(),l.getSeconds()];n.each(h.split("|"),function(n,t){c.push(r[t]||"")});var d=t.getDaysNum(e[0],e[1]+1),a=d==31&&t.digit((new Date).getDate())==31,v=e[2]+i(c[2]||00),y,p;return y=a?v-1:v,o=new Date(e[0]+i(c[0]||00),e[1]+i(c[1]||00),y,e[3]+i(c[3]||00),e[4]+i(c[4]||00),e[5]+i(c[4]||00)),p=a?t.digit(i(o.getDate())+1):t.digit(o.getDate()),t.parse([o.getFullYear(),i(o.getMonth())+1,p],[t.digit(o.getHours()),t.digit(o.getMinutes()),t.digit(o.getSeconds())],u)},t.isValHtml=function(n){return/textarea|input/.test(n[0].tagName.toLocaleLowerCase())},t.isBool=function(n){return n==undefined||n==!0?!0:!1},t.sortDate=function(i,r){var f={},e=[],o=h.split("|"),u=t.checkFormat(r).substring(0,2)=="hh"?!0:!1,s=t.IsNum(i)?t.reMacth(u?i.replace(/(.{2})/g,"$1,"):i.substr(0,4).replace(/^(\d{4})/g,"$1,")+i.substr(4).replace(/(.{2})/g,"$1,")):t.reMacth(i),c=t.IsNum(i)?t.reMacth(u?r.replace(/(.{2})/g,"$1,"):r.substr(0,4).replace(/^(\w{4})/g,"$1,")+r.substr(4).replace(/(.{2})/g,"$1,")):t.reMacth(r);return n.each(s,function(n,t){f[c[n]]=t}),n.each(s,function(n){var t=u?o[3+n]:o[n];e.push(f[t])}),t.IsNum(i)?t.reMacth(u?i.replace(/(.{2})/g,"$1,"):i.substr(0,4).replace(/^(\d{4})/g,"$1,")+i.substr(4).replace(/(.{2})/g,"$1,")):e},c=function(){for(var n="",t=[1,2,3,4,5,6,7,8,9,0],i=0;i<8;i++)n+=t[Math.round(Math.random()*(t.length-1))];return n},r=o.prototype,f="jefixed",r.init=function(){var f=this,i=f.opts,o=new Date,s=i.trigger!=undefined?i.trigger:u.trigger,a=i.zIndex==undefined?2099:i.zIndex,v=i.isinitVal==undefined||i.isinitVal==!1?!1:!0,l,r;t.fixed=t.isBool(i.fixed);var e=i.fixedCell==undefined||i.fixedCell==""?"":"#"+this.opts.fixedCell,p=function(n,t){for(var i=0;i<n.length;i++)if(n[i]==t)return!0;return!1},y=function(n){var e=i.format||u.format,f,s=i.initAddVal||{},r=i.hmsSetVal||{};f=t.isObj(r)?t.parse([o.getFullYear(),t.digit(o.getMonth()+1),t.digit(o.getDate())],[t.digit(r.hh),t.digit(r.mm),t.digit(r.ss)],e):t.returnDate(s,e);(n.val()||n.text())==""?t.isValHtml(n)?n.val(f):n.text(f):t.isValHtml(n)?n.val():n.text()},h=function(r,o){var s=n("<div/>",{id:o.replace(/\#/g,""),"class":"jedatebox "+(i.skinCell||u.skinCell)}),h=n(e).length>0?"relative":t.fixed==!0?"absolute":"fixed";s.attr("author","chen guojun").css({"z-index":o!="#jedatebox"?"":a,position:h,display:"block"});o!="#jedatebox"&&s.attr({jeformat:i.format||u.format,jefixed:e});t.minDate=i.minDate||u.minDate;t.maxDate=i.maxDate||u.maxDate;n(r).append(s);f.setHtml(i,o)};if(v&&s!=!1&&f.valCell.each(function(){y(n(this))}),n(e).length>0)l="#jedatebox"+c(),h(e,l);else if(r=["body","#jedatebox"],s!=!1)f.valCell.on(s,function(t){(t.stopPropagation(),n(r[1]).length>0)||h(r[0],r[1])});else h(r[0],r[1])},r.setHtml=function(i,r){t.boxelem=n(n(r).attr(f)).length>0?r:"#jedatebox";t.format=n(n(r).attr(f)).length>0?n(t.boxelem).attr("jeformat"):i.format||u.format;t.formatType=t.checkFormat(t.format);var s=this,e=n(t.boxelem),h=t.testFormat(t.format,"YYYY-MM"),o=t.testFormat(t.format,"YYYY"),c='<div class="jedatetop"><\/div><div class="jedatetopym" style="display: none;"><ul class="ymdropul"><\/ul><\/div><ol class="jedaol"><\/ol><ul class="'+(h||o?o?"jedayy":"jedaym":"jedaul")+'"><\/ul><div class="jedateprophms"><\/div><div class="jedatebot"><\/div>';e.empty().append(c);s.generateHtml(i,e)},r.isContainhh=function(n){var i=t.checkFormat(n);return t.reMacth("hh-"+i.split("hh")[1])},r.generateHtml=function(r,e){var v=this,l=v.valCell,d="",o,s=new Date,a=r.language||u.language,w=t.testFormat(t.format,"YYYY-MM"),g=t.testFormat(t.format,"YYYY"),y=t.format.substring(0,2)=="hh",b=e.find(".jedatetop"),it=e.find(".jedatetopym"),rt=e.find(".jedaol"),ut=e.find(".jedateprophms"),c=e.find(".jedatebot"),nt,h,p;(l.val()||l.text())==""?(o=[s.getFullYear(),s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()],t.currDate=new Date(o[0],i(o[1])-1,o[2],o[3],o[4],o[5]),t.ymdDate=o[0]+"-"+t.digit(o[1])+"-"+t.digit(o[2])):(nt=t.isValHtml(l)?l.val():l.text(),h=t.sortDate(nt,t.format),y?(o=[s.getFullYear(),s.getMonth()+1,s.getDate(),h[0],h[1]||s.getMinutes(),h[2]||s.getSeconds()],t.currDate=new Date(s.getFullYear(),s.getMonth()-1,s.getDate())):(o=[h[0],h[1]==undefined?s.getMonth()+1:h[1],h[2]==undefined?s.getDate():h[2],h[3]==undefined?s.getHours():h[3],h[4]==undefined?s.getMinutes():h[4],h[5]==undefined?s.getSeconds():h[5]],t.currDate=new Date(o[0],i(o[1])-1,o[2],o[3],o[4],o[5]),t.ymdDate=o[0]+"-"+t.digit(o[1])+"-"+t.digit(o[2])));var ft='<div class="jedatepropcon"><div class="jedatehmstitle">'+(a.name=="cn"?"时间选择":"Time to choose")+'<div class="jedatehmsclose">&times;<\/div><\/div><div class="jedateproptext">'+a.times[0]+'<\/div><div class="jedateproptext">'+a.times[1]+'<\/div><div class="jedateproptext">'+a.times[2]+'<\/div><div class="jedatehmscon jedateprophours"><\/div><div class="jedatehmscon jedatepropminutes"><\/div><div class="jedatehmscon jedatepropseconds"><\/div><\/div>',et='<div class="botflex jedatehmsshde"><ul class="jedatehms"><li><input type="text" maxlength="2" numval="23" hms="0"><\/li><i>:<\/i><li><input type="text" maxlength="2" numval="59" hms="1"><\/li><i>:<\/i><li><input type="text" maxlength="2" numval="59" hms="2"><\/li><\/ul><\/div><div class="botflex jedatebtn"><span class="jedateok">'+a.yes+'<\/span><span class="jedatetodaymonth">'+a.today+'<\/span><span class="jedateclear">'+a.clear+"<\/span><\/div>",ot='<p><span class="jedateymchle">&lt;&lt;<\/span><span class="jedateymchri">&gt;&gt;<\/span><span class="jedateymchok">'+a.close+"<\/span><\/p>";if(y?e.children(".jedatetop,.jedatetopym,.jedaol,.jedaul").remove():b.append('<div class="jedateym" style="width:50%;"><i class="prev triangle monthprev"><\/i><span class="jedatemm" ym="12"><em class="jedatemonth"><\/em><em class="pndrop"><\/em><\/span><i class="next triangle monthnext"><\/i><\/div><div class="jedateym" style="width:50%;"><i class="prev triangle yearprev"><\/i><span class="jedateyy" ym="24"><em class="jedateyear"><\/em><em class="pndrop"><\/em><\/span><i class="next triangle yearnext"><\/i><\/div>'),w||g?(e.children(".jedatetopym,.jedaol").remove(),c.find(".jedatetodaymonth").hide(),b.children().css({width:"100%"}).first().remove(),b.children().find(".pndrop").remove(),e.find(w?".jedaym":".jedayy").append(v.eachYM(r,o[0],o[1],e))):(it.append(ot),rt.append(function(){return n.each(a.weeks,function(n,t){d+='<li class="weeks" data-week="'+t+'">'+t+"<\/li>"}),d})),c.append(et),t.isBool(r.isClear)?"":c.find(".jedateclear").hide(),w||g||y?c.find(".jedatetodaymonth").hide():t.isBool(r.isToday)?"":c.find(".jedatetodaymonth").hide(),t.isBool(r.isok)?"":c.find(".jedateok").hide(),/\DD/.test(t.format)&&v.createDaysHtml(o[0],o[1],r,e),/\hh/.test(t.format)){ut.append(ft).addClass(y?"jedatepropfix":"jedateproppos").css({display:y?"block":"none"});var k=v.isContainhh(t.format),tt=r.hmsSetVal||{},st=(l.val()||l.text())==""&&t.isObj(tt)?tt:{hh:o[3],mm:o[4],ss:o[5]};n.each(["hh","mm","ss"],function(n,i){var u=k[n]==undefined||k[n]=="zz",f=c.find("input[hms="+n+"]");f.val(u?"00":t.digit(st[i])).attr("readOnly",t.isBool(r.ishmsVal)?!1:!0);k.length!=0&&u&&f.attr("disabled",!0)})}else c.find(".jedatehmsshde").hide(),c.find(".jedatebtn").css({width:"100%"});t.isBool(r.isTime)||(c.find(".botflex").css({width:"100%"}),c.find(".jedatehmsshde").hide());v.eventsDate(r,e);n(n(t.boxelem).attr(f)).length==0&&(p=r.position||[],p.length>0?e.css({top:p[0],left:p[1]}):v.orien(e,l));setTimeout(function(){r.success&&r.success(l)},50)},r.createDaysHtml=function(r,f,e,o){var wt=this,s=i(r),h=i(f),k="",tt=0,it=e.language||u.language,c=e.isvalid||[],rt=t.reMacth(t.minDate),ot=rt[0]+rt[1]+rt[2],ut=t.reMacth(t.maxDate),st=ut[0]+ut[1]+ut[2],bt=new Date(s,h-1,1).getDay()||7,kt=t.getDaysNum(s,h),l=t.getPrevMonth(s,h),ht=t.getDaysNum(s,l.m),a=t.getNextMonth(s,h),ct=t.currDate.getFullYear()+"-"+t.digit(t.currDate.getMonth()+1)+"-"+t.digit(1),d=s+"-"+t.digit(h)+"-"+t.digit(1),g,y,lt,at,v,p,vt,yt,pt;o.find(".jedateyear").attr("year",s).text(s+(it.name=="cn"?"年":""));o.find(".jedatemonth").attr("month",h).text(h+(it.name=="cn"?"月":""));var ft=function(i,r,u){var f=e.marks,o=function(n,t){for(var i=n.length;i--;)if(n[i]===t)return!0;return!1};return n.isArray(f)&&f.length>0&&o(f,i+"-"+t.digit(r)+"-"+t.digit(u))?'<i class="marks"><\/i>':""},et=function(n,t,i){var u;if(e.festival==!0&&it.name=="cn"){var r=jeLunar(n,t-1,i),f=r.solarFestival||r.lunarFestival,o=(f&&r.jieqi)!=""?f:r.jieqi||r.showInLunar;u='<p><span class="solar">'+i+'<\/span><span class="lunar">'+o+"<\/span><\/p>"}else u='<p class="nolunar">'+i+"<\/p>";return u},w=function(n,r,u,f){var e=(n+"-"+t.digit(r)+"-"+t.digit(u)).replace(/\-/g,"");if(f){if(i(e)>=i(ot)&&i(e)<=i(st))return!0}else if(i(ot)>i(e)||i(st)<i(e))return!0};for(c.length>0&&(g=new RegExp(c[0].replace(/,/g,"|"))),y=ht-bt+1;y<=ht;y++,tt++)lt=ft(l.y,l.m,y),at=c.length>0?w(l.y,l.m,y,!1)?"disabled":g.test(y)?c[1]==!0?"other":"disabled":c[1]==!0?"disabled":"other":w(l.y,l.m,y,!1)?"disabled":"other",k+='<li data-ymd="'+l.y+"-"+l.m+"-"+y+'" class='+at+">"+(et(l.y,l.m,y)+lt)+"<\/li>";for(v=1;v<=kt;v++,tt++){var nt="",dt=ft(s,h,v),b=s+"-"+t.digit(h)+"-"+t.digit(v);nt=w(s,h,v,!0)?c.length>0?t.ymdDate==b?t.ymdDate==b?"action":ct!=d&&d==b?"action":"":g.test(v)?c[1]==!0?"":"disabled":c[1]==!0?"disabled":"":t.ymdDate==b?"action":ct!=d&&d==b?"action":"":"disabled";nt=="action"&&o.children("ul").attr("dateval",s+"-"+h+"-"+v);k+='<li data-ymd="'+s+"-"+h+"-"+v+'" class='+(nt!=""?nt:"")+">"+(et(s,h,v)+dt)+"<\/li>"}for(p=1,vt=42-tt;p<=vt;p++)yt=ft(a.y,a.m,p),pt=c.length>0?w(a.y,a.m,p,!1)?"disabled":g.test(p)?c[1]==!0?"other":"disabled":c[1]==!0?"disabled":"other":w(a.y,a.m,p,!1)?"disabled":"other",k+='<li data-ymd="'+a.y+"-"+a.m+"-"+p+'" class='+pt+">"+(et(a.y,a.m,p)+yt)+"<\/li>";o.find(".jedaul").empty().html(k);wt.chooseDays(e,o)},r.eachStrhms=function(i,r){var f=this,u=[],e=t.minDate.split(" ")[1]==undefined?"00:00:00":t.minDate.split(" ")[1],o=t.maxDate.split(" ")[1]==undefined?"00:00:00":t.maxDate.split(" ")[1],s=t.reMacth(e),h=t.reMacth(o);return n.each([24,60,60],function(n,e){for(var a="",v="",c=f.isContainhh(t.format),l=r.find(".jedatehms input").eq(n).val(),o=0;o<e;o++)o=t.digit(o),v=t.isBool(i.hmsLimit)?c.length!=0&&(c[n]==undefined||c[n]=="zz")?"disabled":l==o?"action":"":o<s[n]||o>h[n]?o==l?"disabled action":"disabled":o==l?"action":"",a+='<p class="'+v+'">'+o+"<\/p>";u.push(a)}),u},r.eachYM=function(r,f,e,o){var s="",l=r.language||u.language,c,h=this.valCell,a=new Date;return t.testFormat(t.format,"YYYY")?(t.yearArr=new Array(15),n.each(t.yearArr,function(n){var e=t.parseMatch(t.minDate),c=t.parseMatch(t.maxDate),l=e[0],v=c[0],r=f-7+n,y=t.reMacth(t.isValHtml(h)?h.val():h.text()),u=(h.val()||h.text())==""?a.getFullYear():y[0];s+=r<l||r>v?"<li class='disabled' yy='"+r+"'>"+r+"<\/li>":"<li class='"+(i(u)==r?"action":"")+"' yy='"+r+"'>"+r+"<\/li>";i(u)==r&&o.children("ul").attr("dateval",r)}),c=f):(n.each(l.month,function(n,i){var r=t.parseMatch(t.minDate),u=t.parseMatch(t.maxDate),h=new Date(f,t.digit(i),"01"),c=new Date(r[0],r[1],r[2]),l=new Date(u[0],u[1],u[2]);s+=h<c||h>l?"<li class='disabled' ym='"+f+"-"+t.digit(i)+"'>"+f+"-"+t.digit(i)+"<\/li>":"<li class='"+(e==i?"action":"")+"' ym='"+f+"-"+t.digit(i)+"'>"+f+"-"+t.digit(i)+"<\/li>";e==i&&o.children("ul").attr("dateval",f+"-"+t.digit(i))}),c=f+"-"+t.digit(e)),o.find(".jedatetop .jedateyear").text(c),s},r.orien=function(n,i,r){var o,s,f,e,u=t.fixed?i[0].getBoundingClientRect():n[0].getBoundingClientRect();t.fixed?(s=u.right+n.outerWidth()/1.5>=t.winarea(1)?u.right-n.outerWidth():u.left+(r?0:t.docScroll(1)),o=u.bottom+n.outerHeight()/1<=t.winarea()?u.bottom-1:u.top>n.outerHeight()/1.5?u.top-n.outerHeight()-1:t.winarea()-n.outerHeight(),f=Math.max(o+(r?0:t.docScroll())+1,1)+"px",e=s+"px"):(f="50%",e="50%",n.css({"margin-top":-(u.height/2),"margin-left":-(u.width/2)}));n.css({top:f,left:e})},r.lunarOrien=function(n,i,r){var f,e,o,s,u=i[0].getBoundingClientRect();return e=u.right+n[0].offsetWidth/1.5>=t.winarea(1)?u.right-n[0].offsetWidth:u.left+(r?0:t.docScroll(1)),f=u.bottom+n[0].offsetHeight/1<=t.winarea()?u.bottom-1:u.top>n[0].offsetHeight/1.5?u.top-n[0].offsetHeight-1:t.winarea()-n[0].offsetHeight,o=Math.max(f+(r?0:t.docScroll())+1,1)+"px",s=e+"px",{top:o,left:s}},r.dateClose=function(){n(n(t.boxelem).attr(f)).length==0&&n(t.boxelem).remove()},r.eventsDate=function(r,e){var s=this,o=s.valCell,v=r.language||u.language,h=t.checkFormat(t.format).substring(0,2)=="hh";if(h||s.chooseYearMonth(r,e),t.testFormat(t.format,"YYYY")||t.testFormat(t.format,"YYYY-MM")){s.preNextYearMonth(r,e);s.onlyYMevents(r,e)}if(/\hh/.test(t.format)){var y=e.find(".jedateprophours"),p=e.find(".jedatepropminutes"),w=e.find(".jedatepropseconds"),c=e.find(".jedateprophms"),l=155,a=function(){var u=s.eachStrhms(r,e),i=s.isContainhh(t.format);c.css("display","block");n.each([y,p,w],function(n,t){t.html()==""&&t.html(u[n])});n.each(["hours","minutes","seconds"],function(r,u){var f=e.find(".jedateprop"+u),o=f.find(".action"),s=f.find("p");i.length!=0&&i[r]!=undefined&&i[r]!="zz"&&(f[0].scrollTop=o[0].offsetTop-l);s.on("click",function(){var i=n(this);i.hasClass("disabled")||(i.addClass("action").siblings().removeClass("action"),e.find(".jedatebot .jedatehms input").eq(r).val(t.digit(i.text())),h||e.find(".jedateprophms").hide())})})};if(h)a(),c.find(".jedatehmsclose").css("display","none");else e.find(".jedatehms").on("click",function(){a();h||c.find(".jedatehmsclose").on("click",function(){c.css("display","none")})})}e.find(".jedatehms input").on("keyup",function(){var r=n(this),u=r.val(),o=s.isContainhh(t.format),f=i(r.attr("numval")),h=i(r.attr("hms")),c;r.val(u.replace(/\D/g,""));u>f&&(r.val(f),c=v.name=="cn"?"输入值不能大于 ":"The input value is not greater than ",alert(c+f));u==""&&r.val("00");e.find(".jedatehmscon").eq(h).children().each(function(){n(this).removeClass("action")});e.find(".jedatehmscon").eq(h).children().eq(i(r.val().replace(/^0/g,""))).addClass("action");n.each(["hours","minutes","seconds"],function(n,t){var i=e.find(".jedateprop"+t),r=i.find(".action");o.length!=0&&o[n]!=undefined&&(i[0].scrollTop=r[0].offsetTop-l)})});e.find(".jedatebot .jedateclear").on("click",function(i){i.stopPropagation();var u=t.isValHtml(o)?o.val():o.text();t.isValHtml(o)?o.val(""):o.text("");s.dateClose();u!=""&&(t.isBool(r.clearRestore)&&(t.minDate=r.startMin||t.minDate,t.maxDate=r.startMax||t.maxDate),(n.isFunction(r.clearfun)||r.clearfun!=null)&&r.clearfun(o,u))});e.find(".jedatebot .jedatetodaymonth").on("click",function(){var i=new Date,u=[i.getFullYear(),i.getMonth()+1,i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()],h=t.parse([u[0],u[1],u[2]],[u[3],u[4],u[5]],t.format),l=i.getFullYear()+"-"+t.digit(i.getMonth()+1)+"-"+t.digit(i.getDate())+" "+t.digit(i.getHours())+":"+t.digit(i.getMinutes())+":"+t.digit(i.getSeconds()),c;t.isValHtml(o)?o.val(h):t.text(h);n(e.attr(f)).length>0&&(c="#"+e.attr("id"),s.setHtml(r,c));s.dateClose();(n.isFunction(r.choosefun)||r.choosefun!=null)&&r.choosefun(o,h,l)});e.find(".jedatebot .jedateok").on("click",function(u){u.stopPropagation();var c=new Date,l=function(){var t=[];return e.find(".jedatehms input").each(function(){var i=n(this).attr("disabled");typeof i=="undefined"&&t.push(n(this).val())}),t}(),a=h?[c.getFullYear(),c.getMonth()+1,c.getDate()]:t.reMacth(e.children("ul").attr("dateval")),y=n(n(t.boxelem).attr(f)).length>0?e.attr("jeformat"):t.format,v=t.parse([i(a[0]),i(a[1]),i(a[2])],[l[0]||00,l[1]||00,l[2]||00],y),p=(a[0]||c.getFullYear())+"-"+t.digit(a[1]||c.getMonth()+1)+"-"+t.digit(a[2]||c.getDate())+" "+t.digit(l[0]||00)+":"+t.digit(l[1]||00)+":"+t.digit(l[2]||00);t.isValHtml(o)?o.val(v):o.text(v);s.dateClose();(n.isFunction(r.okfun)||r.okfun!=null)&&r.okfun(o,v,p)});n(document).on("mouseup scroll",function(i){if(i.stopPropagation(),t.boxelem=="#jedatebox"){var r=n(t.boxelem);r&&r.css("display")!=="none"&&r.remove();n("#jedatetipscon").length>0&&n("#jedatetipscon").remove()}});n(t.boxelem).on("mouseup",function(n){n.stopPropagation()})},r.chooseDays=function(e,o){var h=this,s=h.valCell,c=new Date,l=e.language||u.language;o.find(".jedaul li").on("click",function(i){var y=n(o.attr(f)).length>0?o.attr("jeformat"):t.format,a=n(this),r=[],v;if(!a.hasClass("disabled")){i.stopPropagation();o.find(".jedatehms input").each(function(){r.push(n(this).val())});var u=t.reMacth(a.attr("data-ymd")),l=t.parse([u[0],u[1],u[2]],[r[0],r[1],r[2]],y),p=(u[0]||c.getFullYear())+"-"+t.digit(u[1]||c.getMonth()+1)+"-"+t.digit(u[2]||c.getDate())+" "+t.digit(r[0])+":"+t.digit(r[1])+":"+t.digit(r[2]);t.isValHtml(s)?s.val(l):s.text(l);n(o.attr(f)).length>0?(v="#"+o.attr("id"),h.setHtml(e,v)):h.dateClose();e.festival&&n("#jedatetipscon").remove();(n.isFunction(e.choosefun)||e.choosefun!=null)&&e.choosefun&&e.choosefun(s,l,p)}});if(e.festival&&l.name=="cn")o.find(".jedaul li").on("mouseover",function(){var h=n(this),o=t.reMacth(h.attr("data-ymd")),f=n("<div/>",{id:"jedatetipscon","class":"jedatetipscon"}),u=jeLunar(i(o[0]),i(o[1])-1,i(o[2])),c="<p>"+u.solarYear+"年"+u.solarMonth+"月"+u.solarDate+"日 "+u.inWeekDays+'<\/p><p class="red">农历：'+u.shengxiao+"年 "+u.lnongMonth+"月"+u.lnongDate+"<\/p><p>"+u.ganzhiYear+"年 "+u.ganzhiMonth+"月 "+u.ganzhiDate+"日<\/p>",l=(u.solarFestival||u.lunarFestival)!=""?'<p class="red">'+("节日："+u.solarFestival+u.lunarFestival)+"<\/p>":"",a=u.jieqi!=""?'<p class="red">'+(u.jieqi!=""?"节气："+u.jieqi:"")+"<\/p>":"",v=(u.solarFestival||u.lunarFestival||u.jieqi)!=""?l+a:"",s;n("body").append(f);f.html(c+v);s=r.lunarOrien(f,h);f.css({"z-index":e.zIndex==undefined?2104:e.zIndex+5,top:s.top,left:s.left,position:"absolute",display:"block"})}).on("mouseout",function(){n("#jedatetipscon").length>0&&n("#jedatetipscon").remove()})},r.chooseYearMonth=function(r,f){var h=this,w=f.find(".yearprev"),d=f.find(".yearnext"),b=f.find(".monthprev"),g=f.find(".monthnext"),c=f.find(".jedatetopym"),l=f.find(".jedateyy"),nt=f.find(".jedatemm"),e=f.find(".jedateyy .jedateyear"),s=f.find(".jedatemm .jedatemonth"),o=r.language||u.language,y=f.find(".jedateymchri"),p=f.find(".jedateymchle"),a=t.reMacth(t.minDate),tt=a[0]+a[1],v=t.reMacth(t.maxDate),it=v[0]+v[1],k=function(t){var u="",r;return n.each(new Array(15),function(n){if(n===7){var f=e.attr("year");r=i(t)>=i(a[0])&&i(t)<=i(v[0])?f==t?'class="action"':"":'class="disabled"';u+="<li "+r+' yy="'+t+'">'+(t+(o.name=="cn"?"年":""))+"<\/li>"}else r=i(t-7+n)>=i(a[0])&&i(t-7+n)<=i(v[0])?"":'class="disabled"',u+="<li "+r+' yy="'+(t-7+n)+'">'+(t-7+n+(o.name=="cn"?"年":""))+"<\/li>"}),u},rt=function(r,u){var h="";u==12?(n.each(o.month,function(n,r){var u=s.attr("month"),r=t.digit(r),f=i(e.attr("year")+r)>=i(tt)&&i(e.attr("year")+r)<=i(it)?t.digit(u)==r?"action":"":"disabled";h+="<li class='"+f+"' mm='"+r+"'>"+(r+(o.name=="cn"?"月":""))+"<\/li>"}),n.each([y,p],function(n,t){t.hide()})):(h=k(r),n.each([y,p],function(n,t){t.show()}));c.removeClass(u==12?"jedatesety":"jedatesetm").addClass(u==12?"jedatesetm":"jedatesety");f.find(".jedatetopym .ymdropul").html(h);c.show()};n.each([w,d],function(n,t){t.on("click",function(n){if(f.find(".jedatetopym").css("display")!="block"){n.stopPropagation();var u=i(e.attr("year")),o=i(s.attr("month")),c=t==w?--u:++u;h.createDaysHtml(c,o,r,f)}})});n.each([b,g],function(n,u){u.on("click",function(n){if(f.find(".jedatetopym").css("display")!="block"){n.stopPropagation();var o=i(e.attr("year")),c=i(s.attr("month")),l=t.getPrevMonth(o,c),a=t.getNextMonth(o,c);u==b?h.createDaysHtml(l.y,l.m,r,f):h.createDaysHtml(a.y,a.m,r,f)}})});n.each([l,nt],function(u,a){a.on("click",function(){var w=n(this),b=w.attr("ym"),u=i(e.attr("year")),v=function(){f.find(".ymdropul li").on("click",function(u){var v=n(this),y=l==a?i(v.attr("yy")):i(e.attr("year")),p=l==a?i(s.attr("month")):t.digit(i(v.attr("mm")));v.hasClass("disabled")||(u.stopPropagation(),l==a?e.attr("year",y).html(y+(o.name=="cn"?"年":"")):s.attr("month",p).html(p+(o.name=="cn"?"月":"")),c.hide(),h.createDaysHtml(y,p,r,f))})};rt(u,b);v();f.find(".jedateymchok").on("click",function(n){n.stopPropagation();c.hide()});n.each([p,y],function(n,t){t.on("click",function(t){t.stopPropagation();n==0?u-=15:u+=15;var i=k(u);f.find(".jedatetopym .ymdropul").html(i);v()})})})})},r.preNextYearMonth=function(i,r){var e=this,u=e.valCell,o=new Date,f=t.testFormat(t.format,"YYYY"),s=r.find(f?".jedayy li":".jedaym li");s.on("click",function(r){if(!n(this).hasClass("disabled")){r.stopPropagation();var s=f?t.reMacth(n(this).attr("yy")):t.reMacth(n(this).attr("ym")),h=f?t.parse([s[0],o.getMonth()+1,1],[0,0,0],t.format):t.parse([s[0],s[1],1],[0,0,0],t.format);t.isValHtml(u)?u.val(h):u.text(h);e.dateClose();(n.isFunction(i.choosefun)||i.choosefun!=null)&&i.choosefun(u,h)}})},r.onlyYMevents=function(r,u){var e=this,f,c=new Date,l=t.testFormat(t.format,"YYYY"),o=u.find(".jedateym .prev"),a=u.find(".jedateym .next"),s=t.reMacth(u.children("ul").attr("dateval")),h=i(s[0]),v=i(s[1]);n.each([o,a],function(n,i){i.on("click",function(n){n.stopPropagation();l?(f=i==o?u.find(".jedayy li").eq(0).attr("yy"):u.find(".jedayy li").eq(t.yearArr.length-1).attr("yy"),u.find(".jedayy").html(e.eachYM(r,f,c.getMonth()+1,u))):(f=i==o?h-=1:h+=1,u.find(".jedaym").html(e.eachYM(r,f,v,u)));e.preNextYearMonth(r,u)})})},n.dateVer="3.8.3",n.nowDate=function(n,i,r){return i=i||"YYYY-MM-DD hh:mm:ss",r=r||[],t.returnDate(n,i,r)},n.timeStampDate=function(n,r,u){var f;if(u=u||"YYYY-MM-DD hh:mm:ss",r==!0)return f=new Date(i(n.substring(0,10))*1e3),t.parse([f.getFullYear(),t.digit(f.getMonth()),t.digit(f.getDate())],[t.digit(f.getHours()),t.digit(f.getMinutes()),t.digit(f.getSeconds())],u);var e=t.reMacth(n),o=new Date(e[0],e[1],e[2],e[3],e[4],e[5]),s=o.getTime().toString();return s.substr(0,10)},n.splitDate=function(n){var t=n.match(/\w+|d+/g);return{YYYY:i(t[0]),MM:i(t[1])||00,DD:i(t[2])||00,hh:i(t[3])||00,mm:i(t[4])||00,ss:i(t[5])||00}},n.getLunar=function(n){if(/\YYYY-MM-DD/.test(t.formatType)){var f=n.substr(0,4).replace(/^(\d{4})/g,"$1,")+n.substr(4).replace(/(.{2})/g,"$1,"),u=t.IsNum(n)?t.reMacth(f):t.reMacth(n),r=jeLunar(u[0],u[1]-1,u[2]);return{nMonth:r.lnongMonth,nDays:r.lnongDate,yYear:i(r.solarYear),yMonth:i(r.solarMonth),yDays:i(r.solarDate),cWeek:r.inWeekDays,nWeek:r.solarWeekDay}}},o}),function(n,t){n.jeLunar=t(n.jeLunar)}(this,function(){function l(l){var w=function(n,t){var i=new Date(31556925974.7*(n-1900)+f[t]*6e4+Date.UTC(1900,0,6,2,5));return i.getUTCDate()},g=function(t){for(var r=348,i=32768;i>8;i>>=1)r+=n[t-1900]&i?1:0;return r+b(t)},p=function(n){return e.charAt(n%10)+o.charAt(n%12)},b=function(t){return k(t)?n[t-1900]&65536?30:29:0},k=function(t){return n[t-1900]&15},d=function(t,i){return n[t-1900]&65536>>i?30:29},nt=function(n){var t,u=0,r=0,f=new Date(1900,0,31),i=(n-f)/864e5;for(this.dayCyl=i+40,this.monCyl=14,t=1900;t<2050&&i>0;t++)r=g(t),i-=r,this.monCyl+=12;for(i<0&&(i+=r,t--,this.monCyl-=12),this.year=t,this.yearCyl=t-1864,u=k(t),this.isLeap=!1,t=1;t<13&&i>0;t++)u>0&&t==u+1&&this.isLeap==!1?(--t,this.isLeap=!0,r=b(this.year)):r=d(this.year,t),this.isLeap==!0&&t==u+1&&(this.isLeap=!1),i-=r,this.isLeap==!1&&this.monCyl++;i==0&&u>0&&t==u+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--t,--this.monCyl));i<0&&(i+=r,--t,--this.monCyl);this.month=t;this.day=i+1},y=function(n){return n<10?"0"+(n|0):n},v=function(n,t){var i=n;return t.replace(/dd?d?d?|MM?M?M?|yy?y?y?/g,function(n){switch(n){case"yyyy":var t="000"+i.getFullYear();return t.substring(t.length-4);case"dd":return y(i.getDate());case"d":return i.getDate().toString();case"MM":return y(i.getMonth()+1);case"M":return i.getMonth()+1}})},tt=function(n,t){var r;switch(n,t){case 10:r="初十";break;case 20:r="二十";break;case 30:r="三十";break;default:r=h.charAt(Math.floor(t/10))+i.charAt(t%10)}return r},a;this.isToday=!1;this.isRestDay=!1;this.solarYear=v(l,"yyyy");this.solarMonth=v(l,"M");this.solarDate=v(l,"d");this.solarWeekDay=l.getDay();this.inWeekDays="星期"+i.charAt(this.solarWeekDay);a=new nt(l);this.lunarYear=a.year;this.shengxiao=s.charAt((this.lunarYear-4)%12);this.lunarMonth=a.month;this.lunarIsLeapMonth=a.isLeap;this.lnongMonth=this.lunarIsLeapMonth?"闰"+r[a.month-1]:r[a.month-1];this.lunarDate=a.day;this.showInLunar=this.lnongDate=tt(this.lunarMonth,this.lunarDate);this.lunarDate==1&&(this.showInLunar=this.lnongMonth+"月");this.ganzhiYear=p(a.yearCyl);this.ganzhiMonth=p(a.monCyl);this.ganzhiDate=p(a.dayCyl++);this.jieqi="";this.restDays=0;w(this.solarYear,(this.solarMonth-1)*2)==v(l,"d")&&(this.showInLunar=this.jieqi=t[(this.solarMonth-1)*2]);w(this.solarYear,(this.solarMonth-1)*2+1)==v(l,"d")&&(this.showInLunar=this.jieqi=t[(this.solarMonth-1)*2+1]);this.showInLunar=="清明"&&(this.showInLunar="清明节",this.restDays=1);this.solarFestival=c[v(l,"MM")+v(l,"dd")];typeof this.solarFestival=="undefined"?this.solarFestival="":/\*(\d)/.test(this.solarFestival)&&(this.restDays=parseInt(RegExp.$1),this.solarFestival=this.solarFestival.replace(/\*\d/,""));this.showInLunar=this.solarFestival==""?this.showInLunar:this.solarFestival;this.lunarFestival=u[this.lunarIsLeapMonth?"00":y(this.lunarMonth)+y(this.lunarDate)];typeof this.lunarFestival=="undefined"?this.lunarFestival="":/\*(\d)/.test(this.lunarFestival)&&(this.restDays=this.restDays>parseInt(RegExp.$1)?this.restDays:parseInt(RegExp.$1),this.lunarFestival=this.lunarFestival.replace(/\*\d/,""));this.lunarMonth==12&&this.lunarDate==d(this.lunarYear,12)&&(this.lunarFestival=u["0100"],this.restDays=1);this.showInLunar=this.lunarFestival==""?this.showInLunar:this.lunarFestival}var n=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448],f=[0,21208,43467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758],e="甲乙丙丁戊己庚辛壬癸",o="子丑寅卯辰巳午未申酉戌亥",s="鼠牛虎兔龙蛇马羊猴鸡狗猪",t=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],i="日一二三四五六七八九十",h="初十廿卅",r=["正","二","三","四","五","六","七","八","九","十","十一","腊"],c={"0101":"*1元旦节","0202":"湿地日","0214":"情人节","0308":"妇女节","0312":"植树节","0315":"消费者权益日","0401":"愚人节","0422":"地球日","0501":"*1劳动节","0504":"青年节","0512":"护士节","0518":"博物馆日","0520":"母亲节","0601":"儿童节","0623":"奥林匹克日","0630":"父亲节","0701":"建党节","0801":"建军节","0903":"抗战胜利日","0910":"教师节","1001":"*3国庆节","1201":"艾滋病日","1224":"平安夜","1225":"圣诞节"},u={"0100":"除夕","0101":"*2春节","0115":"元宵节","0505":"*1端午节","0707":"七夕节","0715":"中元节","0815":"*1中秋节","0909":"*1重阳节","1015":"下元节","1208":"腊八节","1223":"小年"};return function(n,t,i){return new l(new Date(n,t,i))}});