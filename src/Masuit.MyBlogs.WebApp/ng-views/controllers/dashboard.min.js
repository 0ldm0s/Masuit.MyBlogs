myApp.controller("dashboard",["$scope","$http","Hub","$timeout","$location",function(n,t,i,r,u){var f,e;n.loading();n.distinct=!0;var c=[],l=[],a=[],o=0,s=0,h=0,p=0,v=0,w=0,b=0,y=0;n.cpu={};n.memory={};f=new i("myhub",{rootPath:"/signalr",listeners:{receiveLoad:function(t){t=JSON.parse(t);c.push(t);o=t[1];s=t[2];h=t[3];n.cpu.CpuLoad=o;n.memory.MemoryUsage=s;n.cpu.Temperature=h;n.$apply()},receiveReadWrite:function(n){n=JSON.parse(n);a.push(n);p=n[1];v=n[2];y=v},receiveUpDown:function(n){n=JSON.parse(n);l.push(n);w=n[1];b=n[2]}},methods:["update"],errorHandler:function(){},stateChanged:function(n){switch(n.newState){case $.signalR.connectionState.connected:f.update()}}});window.hub=f;n.isPush=n.isPush?n.isPush:!0;ifvisible.idle(function(){f.disconnect()});ifvisible.blur(function(){f.disconnect()});ifvisible.wakeup(function(){n.isPush&&u.url()==="/home"&&f.connect()});n.ClearMemory=function(){console.log("111");n.request("/system/CollectMemory",null,function(n){swal(n.Message,"","info")})};t.post("/system/GetBaseInfo",null).then(function(t){var i=t.data;n.cpu=i.cpuInfo[0];n.cores=i.cpuInfo.length;n.memory=i.ramInfo;n.disk=i.diskInfo;n.osVersion=i.osVersion;n.netInfo=i.netInfo;n.RunningTime=i.runningTime;n.BootTime=i.bootTime});n.push="停止";n.StopPush=function(){n.isPush?(f.disconnect(),n.push="开始",n.isPush=!1):(f.connect(),n.push="停止",n.isPush=!0)};$.post("/system/GetHistoryList",null,function(t){$("#cpu").highcharts("StockChart",{chart:{backgroundColor:"transparent",animation:Highcharts.svg,events:{load:function(){var n=this.series[0],t=this.series[1],i=this.series[2];setInterval(function(){let r=c.pop();r&&(n.addPoint([r[0],r[1]],!0,!0),t.addPoint([r[0],r[2]],!0,!0),i.addPoint([r[0],r[3]],!0,!0))},2e3)},backgroundColor:"transparent"}},credits:{enabled:!1},boost:{useGPUTranslations:!0},plotOptions:{series:{showInNavigator:!0,marker:{enabled:!1}}},legend:{align:"right",verticalAlign:"top",floating:!0,x:-50,y:0},rangeSelector:{buttons:[{type:"minute",count:5,text:"5分钟"},{type:"minute",count:15,text:"15分钟"},{type:"minute",count:30,text:"半小时"},{type:"hour",count:1,text:"1小时"},{type:"hour",count:3,text:"3小时"},{type:"hour",count:6,text:"6小时"},{type:"hour",count:12,text:"12小时"},{type:"all",count:1,text:"所有"}],selected:1,inputEnabled:!1},title:{text:"资源使用率"},xAxis:{type:"datetime",tickPixelInterval:150},yAxis:[{title:{text:"使用率（%）"},min:0,opposite:!1},{title:{text:"CPU内核温度（℃）"},min:40,opposite:!0}],exporting:{enabled:!1},scrollbar:{enabled:!1},tooltip:{formatter:function(){return"时间点：<b>"+Highcharts.dateFormat("%H:%M:%S",this.points[0].x)+'<\/b><br/><span style="color:'+Highcharts.getOptions().colors[0]+'">CPU使用率：<b>'+Highcharts.numberFormat(this.points[0].y,2)+'%<\/b><\/span><br/><span style="color:'+Highcharts.getOptions().colors[1]+'">内存使用率：<b>'+Highcharts.numberFormat(this.points[1].y,2)+'%<\/b><\/span><br/><span style="color:'+Highcharts.getOptions().colors[35]+'">CPU内核温度：<b>'+Highcharts.numberFormat(this.points[2].y,0)+"℃<\/b><\/span><br/>"},crosshairs:!0,shared:!0},series:[{name:"CPU使用率",type:"areaspline",data:t.cpu,tooltip:{valueSuffix:" %"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:0,stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}},{name:"内存使用率",type:"areaspline",data:t.mem,tooltip:{valueSuffix:" %"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:1,stops:[[0,Highcharts.getOptions().colors[1]],[1,Highcharts.Color(Highcharts.getOptions().colors[1]).setOpacity(0).get("rgba")]]}},{name:"CPU温度",yAxis:1,data:t.temp,type:"areaspline",tooltip:{valueSuffix:"℃"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:2,stops:[[0,Highcharts.getOptions().colors[35]],[1,Highcharts.Color(Highcharts.getOptions().colors[35]).setOpacity(0).get("rgba")]]}}]});$("#io").highcharts("StockChart",{chart:{backgroundColor:"transparent",animation:Highcharts.svg,events:{load:function(){var n=this.series[0],t=this.series[1],i=this.series[2],r=this.series[3];setInterval(function(){let u=a.pop(),f=l.pop();u&&(n.addPoint([u[0],u[1]],!0,!0),t.addPoint([u[0],u[2]],!0,!0),i.addPoint([f[0],f[2]],!0,!0),r.addPoint([f[0],f[2]],!0,!0))},2e3)}}},boost:{useGPUTranslations:!0},credits:{enabled:!1},plotOptions:{series:{showInNavigator:!0,marker:{enabled:!1}}},legend:{align:"right",verticalAlign:"top",floating:!0,x:-50,y:0},rangeSelector:{buttons:[{type:"minute",count:5,text:"5分钟"},{type:"minute",count:15,text:"15分钟"},{type:"minute",count:30,text:"半小时"},{type:"hour",count:1,text:"1小时"},{type:"hour",count:3,text:"3小时"},{type:"hour",count:6,text:"6小时"},{type:"hour",count:12,text:"12小时"},{type:"all",count:1,text:"所有"}],selected:1,inputEnabled:!1},title:{text:"网络状态 和 磁盘I/O"},xAxis:{type:"datetime",tickPixelInterval:150},yAxis:[{title:{text:"磁盘I/O速率(KBps)"},min:0,opposite:!0},{title:{text:"网络速率(KBps)"},min:0,opposite:!1},],tooltip:{formatter:function(){return"时间点：<b>"+Highcharts.dateFormat("%H:%M:%S",this.points[0].x)+'<\/b><br/><span style="color:'+Highcharts.getOptions().colors[0]+'">磁盘读：<b>'+Highcharts.numberFormat(this.points[0].y,0)+'KBps<\/b><\/span><br/><span style="color:'+Highcharts.getOptions().colors[2]+'">磁盘写：<b>'+Highcharts.numberFormat(this.points[1].y,0)+'KBps<\/b><\/span><br/><span style="color:'+Highcharts.getOptions().colors[39]+'">网络上行：<b>'+Highcharts.numberFormat(this.points[2].y,0)+'KBps<\/b><\/span><br/><span style="color:'+Highcharts.getOptions().colors[35]+'">网络下行：<b>'+Highcharts.numberFormat(this.points[3].y,0)+"KBps<\/b><\/span><br/>"},crosshairs:!0,shared:!0},exporting:{enabled:!1},scrollbar:{enabled:!1},series:[{name:"磁盘读",type:"spline",data:t.read,yAxis:0,tooltip:{valueSuffix:"KBps"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:0,stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}},{name:"磁盘写",type:"spline",data:t.write,yAxis:0,tooltip:{valueSuffix:"KBps"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:1,stops:[[0,Highcharts.getOptions().colors[2]],[1,Highcharts.Color(Highcharts.getOptions().colors[2]).setOpacity(0).get("rgba")]]}},{name:"网络上行",type:"spline",data:t.up,yAxis:1,tooltip:{valueSuffix:"KBps"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:1,stops:[[0,Highcharts.getOptions().colors[39]],[1,Highcharts.Color(Highcharts.getOptions().colors[39]).setOpacity(0).get("rgba")]]}},{name:"网络下行",type:"spline",data:t.down,yAxis:1,tooltip:{valueSuffix:"KBps"},fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},yAxis:1,stops:[[0,Highcharts.getOptions().colors[35]],[1,Highcharts.Color(Highcharts.getOptions().colors[35]).setOpacity(0).get("rgba")]]}}]});n.loadingDone()});e={chart:{backgroundColor:"transparent",type:"solidgauge"},title:null,pane:{center:["50%","85%"],size:"140%",startAngle:-90,endAngle:90,background:{backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"#EEE",innerRadius:"60%",outerRadius:"100%",shape:"arc"}},tooltip:{enabled:!1},yAxis:{stops:[[.1,"#55BF3B"],[.5,"#DDDF0D"],[.9,"#DF5353"]],lineWidth:0,minorTickInterval:null,tickPixelInterval:400,tickWidth:0,title:{y:-70},labels:{y:16}},plotOptions:{solidgauge:{dataLabels:{y:5,borderWidth:0,useHTML:!0}}}};$("#container-speed").highcharts(Highcharts.merge(e,{yAxis:{min:0,max:100,title:{text:"CPU使用率"}},boost:{useGPUTranslations:!0},credits:{enabled:!1},series:[{name:"CPU使用率",data:[0],dataLabels:{format:'<div style="text-align:center"><span style="font-size:25px;color:'+(Highcharts.theme&&Highcharts.theme.contrastTextColor||"black")+'">{y:.2f}%<\/span><br/>'},tooltip:{valueSuffix:"%"}}]}));$("#container-rpm").highcharts(Highcharts.merge(e,{yAxis:{min:0,max:100,title:{text:"内存使用率"}},boost:{useGPUTranslations:!0},credits:{enabled:!1},series:[{name:"内存使用率",data:[0],dataLabels:{format:'<div style="text-align:center"><span style="font-size:25px;color:'+(Highcharts.theme&&Highcharts.theme.contrastTextColor||"black")+'">{y:.1f}%<\/span><br/>'},tooltip:{valueSuffix:" %"}}]}));$("#container-temp").highcharts(Highcharts.merge(e,{yAxis:{min:0,max:100,title:{text:"CPU当前温度"}},boost:{useGPUTranslations:!0},credits:{enabled:!1},series:[{name:"CPU当前温度",data:[1],dataLabels:{format:'<div style="text-align:center"><span style="font-size:25px;color:'+(Highcharts.theme&&Highcharts.theme.contrastTextColor||"black")+'">{y}℃<\/span><br/>'},tooltip:{valueSuffix:" ℃"}}]}));$("#container-io").highcharts(Highcharts.merge(e,{yAxis:{min:0,max:5e5,title:{text:"磁盘I/O"}},boost:{useGPUTranslations:!0},credits:{enabled:!1},series:[{name:"磁盘I/O",data:[1],dataLabels:{format:'<div style="text-align:center"><span style="font-size:25px;color:'+(Highcharts.theme&&Highcharts.theme.contrastTextColor||"black")+'">{y:.0f}KBps<\/span><br/>'},tooltip:{valueSuffix:" KBps"}}]}));setInterval(function(){var n=$("#container-speed").highcharts(),t;n&&(t=n.series[0].points[0],t.update(o));n=$("#container-rpm").highcharts();n&&(t=n.series[0].points[0],t.update(s));n=$("#container-temp").highcharts();n&&(t=n.series[0].points[0],t.update(h));n=$("#container-io").highcharts();n&&(t=n.series[0].points[0],t.update(y))},1e3)}]);